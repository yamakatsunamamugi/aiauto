回答するための条件
初心者でもわかるように、詳細に具体例を交えながら記載すること。

まずは作業をするのではなく、Explore, Planを重視して、Codeをいきなり書き始めないこと。

作業には以下のMCPを使うこと
最新情報が必要なときは Playwright MCPを使うこと。

こちらがやるべきことがある場合、初心者にもわかるように丁寧に解説すること。
こちらがスクリプトを稼働させる必要がある場合、どのアプリで、ファイルパスとpython名を選択できて、コピペで稼働できるようにすること。

作業が一区切り終了したら、プッシュしてください。と記載すること

効率的な開発フロー（Explore, Plan, Code, Commit）:
Explore（探索）: まずは関連ファイルを読み込ませ、プロジェクトを理解させます。

Plan（計画）: いきなりコードを書かせるのではなく、どう実装するかの計画を立てさせます。（think harderを使うこと。

→ここではequential Thinking MCPを使うこと。

Code（実装）: 計画に合意してから、実際のコーディングを指示します。
コーディングする際はエラーが特定しやすいようにログを詳細につけるようにすること。
コーディングをするときはContext7 MCPを利用すること。
Code終了後、Githubでプッシュとコミットをすること。コミットには作業関係や修正点、全体のゴールを記載すること。
初めてやる場合は、やり方はhttps://docs.google.com/spreadsheets/d/1icMjQyY2YY1uuGB12ISoxFSrDseRwjLrmSUxiyqubZo/edit?gid=400836539#gid=400836539のシート「Github連携の仕方」を見る。

・できる限り細かく作業を分割して、エラー等と特定しやすくすること。
・エラーが10回以上出続ける合は、Playwright MCPを活用して、Githubで最新の情報を調べたうえで、新しい解決策を提案すること。

ステップ① 目的と要件の明確化 (改訂版)

1. ゴール Googleスプレッドシート上の指定されたデータを元に、特定のウェブサイト（AIツール）を操作し、その結果をスプレッドシートに書き戻す作業を自動化する。
GUIで作成すること。

2. 設定
対象スプレッドシート:
Googleスプレッドシート。
GUI上でURLを入力
対象シート名は読み取って選択できるように設定


作業指示行（ヘッダー行）:
シートの5行目。
A列のセルに「作業指示行」という文字列がある行。
この作業指示行に、「コピー」などのテキストが含まれる。

処理対象データ行:


A列に**「1」という値が入っている行から**処理を開始。＝これが処理対象行です
A列に「1」「2」「3」… といった連番が入力されている行が処理対象。
A列が空白になった時点で処理終了。

「コピー」列:
「作業指示行」（5行目）を左から右へ検索し、セルの値が「コピー」と完全に一致する列。複数存在する可能性あり、リストとして保持し順次処理。
こちらのテキストをコピーしてAIに貼り付ける。

「処理列」:
「コピー」列が見つかった場合、その「コピー」列から左に2つ隣の列 (カレントコピー列 - 2)。
この列の値が「空白」または「未処理」の場合に、AIへの処理を実行する。
処理をしたら処理済みと記載する。
「エラー列」:
「コピー」列が見つかった場合、その「コピー」列から左に1つ隣の列 (カレントコピー列 - 1)。ここにはエラーの詳細を記載。

「貼り付け列」:
「コピー」列が見つかった場合、その「コピー」列の右隣の列 (カレントコピー列 + 1)
ここにAIが作成した回答を貼り付ける。

２．出力する前に↓の作業を行う
各作業列について、使用するAIを選択
各コピー列で作業するAIについて、使うAIをプルダウン方式で選択できるようにする。
今のAIは右です。（ChatGPT、Claude,Gemini、Genspark、Google AI Stsuio）
各AIで手動ログイン(いつも使っているグーグルクロームから開く。ログイン済みの。)

各AIにあるモデルを抽出
各AIのモデルをブルダウン方式で選択できるようにする（各自最新のモデルを取得）
設定等を選択できるように設定（記入欄の近くにある設定 DeepThink等をすべてチェック等で選択できるようにする）これも最新情報を取得
選択を待つ

ログイン後、↓の作業を行う

4. 処理手順の概要
対象スプレッドシートのURL（初期は固定、将来は入力）とシート名（初期は固定、将来は選択）を取得。
A列を検索し、「作業」セルを見つける。ここを「作業指示行」とする。
「作業指示行」から「コピー」というヘッダーを持つ列を全て特定し、リストに保持。
「コピー」列リストが空ならメッセージを表示して終了。
「コピー」列リストの各「コピー」列に対して以下をループ：

 a. カレント「コピー」列を基準に、「処理列」（コピー列-2）、「エラー列」（コピー列-1）、「貼り付け列」（コピー列+1）の位置を計算し、境界チェック（1列目より左にならないか等）。
 b. A列が「1」の行から処理を開始し、A列が空白になるまでループ。
各行で以下を実行：

2. カレント「コピー」列の現在の行のテキストを読み取る。
3. 2のテキストをAIサイトの入力欄にペーストし、処理を実行。 
4. AIの処理完了（特定ボタンの出現など）を待つ。 
5. 回答結果テキストをコピー。 
6. 「貼り付け列」の現在の行にペースト。 
c. エラー発生時は「エラー列」に記録し、5回まで10秒待機してリトライ。だめなら次。
それでもダメなら次の処理（次の行または次のコピー列）へ。このエラーの内容を「エラー列」に書き込む。
全ての「コピー」列、全ての処理対象行の処理が完了したら終了。


5. 実行環境

macで開発、実行。
最終的にはWindows仮想デスクトップ上でもできるようにすること。
Python本体、Seleniumライブラリ、Google Client Libraryなどのインストール権限あり。
Google APIへのアクセス可能なネットワーク環境。

