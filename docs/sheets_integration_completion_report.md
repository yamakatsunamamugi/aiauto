# æ‹…å½“è€…B (Sheets) ä½œæ¥­å®Œäº†å ±å‘Šæ›¸

## ğŸ“Š ä½œæ¥­æ¦‚è¦

**ä½œæ¥­æœŸé–“**: 2025å¹´6æœˆ11æ—¥  
**æ‹…å½“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**: Google Sheetsé€£æºæ©Ÿèƒ½  
**ä½œæ¥­çŠ¶æ³**: âœ… å®Œäº†

## âœ… å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯

### 1. Google Sheets APIè¨­å®š
- âœ… èªè¨¼è¨­å®šã‚¬ã‚¤ãƒ‰ã®ä½œæˆ (`docs/google_sheets_api_setup_guide.md`)
- âœ… è¨­å®šãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆ (`check_google_sheets_setup.py`)
- âš ï¸ **è¦å¯¾å¿œ**: `credentials.json`ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šãŒå¿…è¦

### 2. å®Ÿè£…æ¸ˆã¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

#### auth_manager.py
- âœ… ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼
- âœ… ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ç¢ºèª
- âœ… èªè¨¼ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### models.py
- âœ… TaskStatusã€AIServiceåˆ—æŒ™å‹
- âœ… ColumnPositionã€ColumnAIConfig
- âœ… TaskRowã€SheetConfig
- âœ… ProcessingResult

#### sheets_client.py
- âœ… ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆèª­ã¿æ›¸ã
- âœ… ãƒãƒƒãƒæ›´æ–°æ©Ÿèƒ½
- âœ… ã‚¿ã‚¹ã‚¯çŠ¶æ…‹ç®¡ç†
- âœ… APIåˆ¶é™å¯¾å¿œ

#### data_handler.py
- âœ… CLAUDE.mdä»•æ§˜æº–æ‹ ã®å®Ÿè£…
- âœ… ä½œæ¥­è¡Œãƒ»ã‚³ãƒ”ãƒ¼åˆ—æ¤œç´¢
- âœ… ã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒ»ç®¡ç†
- âœ… åˆ—æ¯AIè¨­å®šã‚µãƒãƒ¼ãƒˆ

### 3. ãƒ†ã‚¹ãƒˆ
- âœ… å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆ (`tests/test_sheets_unit.py`)
- âœ… çµ±åˆãƒ†ã‚¹ãƒˆæ—¢å­˜ (`tests/test_sheets_integration.py`)
- âœ… å…¨15ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹åˆæ ¼

## ğŸ”— ä»–æ‹…å½“è€…ã¨ã®é€£æºãƒã‚¤ãƒ³ãƒˆ

### æ‹…å½“è€…A (GUI) ã¸ã®æä¾›æ©Ÿèƒ½
```python
# ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæƒ…å ±å–å¾—
def get_sheet_names(url: str) -> List[str]

# ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ç¢ºèª
def validate_spreadsheet_access(url: str) -> bool

# è¨­å®šæ¤œè¨¼
def validate_sheet_configuration(config: SheetConfig) -> Tuple[bool, List[str]]
```

### æ‹…å½“è€…C (Automation) ã¸ã®æä¾›æ©Ÿèƒ½
```python
# ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆå–å¾—
tasks = data_handler.get_pending_tasks(config)

# çµæœæ›´æ–°
data_handler.update_task_result(spreadsheet_id, sheet_name, task, result)
```

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### 1. èªè¨¼è¨­å®š
```bash
# è¨­å®šçŠ¶æ³ç¢ºèª
python3 check_google_sheets_setup.py

# èªè¨¼ãƒ†ã‚¹ãƒˆ
python3 -m src.sheets.auth_manager
```

### 2. å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
python3 -m pytest tests/test_sheets_unit.py -v
```

### 3. çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
python3 tests/test_sheets_integration.py <spreadsheet_url> <sheet_name>
```

## âš ï¸ æ³¨æ„äº‹é …

1. **credentials.jsonæœªè¨­å®š**
   - Google Cloud Consoleã§ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
   - JSONã‚­ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦`config/credentials.json`ã«ä¿å­˜
   - è©³ç´°ã¯`docs/google_sheets_api_setup_guide.md`å‚ç…§

2. **ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ¨©é™**
   - ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç·¨é›†è€…ã¨ã—ã¦è¿½åŠ å¿…è¦
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯èªè¨¼å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹

3. **APIåˆ¶é™**
   - 1åˆ†é–“ã«60ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§
   - ãƒãƒƒãƒå‡¦ç†ã§è‡ªå‹•å¯¾å¿œæ¸ˆã¿

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. credentials.jsonã®è¨­å®š
2. ãƒ†ã‚¹ãƒˆç”¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ã®å‹•ä½œç¢ºèª
3. ä»–æ‹…å½“è€…ã¨ã®çµ±åˆãƒ†ã‚¹ãƒˆ
4. æœ¬ç•ªç’°å¢ƒã§ã®å‹•ä½œç¢ºèª

## ğŸ“ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Google Sheets APIè¨­å®šã‚¬ã‚¤ãƒ‰](google_sheets_api_setup_guide.md)
- [AIè‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ä½œæ¥­æŒ‡ç¤ºæ›¸](../å…¨ä½“å…±é€šæŒ‡ç¤ºæ›¸.md)
- [æ‹…å½“è€…B_SheetsæŒ‡ç¤ºæ›¸](æ‹…å½“è€…B_SheetsæŒ‡ç¤ºæ›¸.md)

## ğŸ’¬ é€£çµ¡äº‹é …

Sheetsãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å®Ÿè£…ã¯å®Œäº†ã—ã¾ã—ãŸã€‚credentials.jsonã®è¨­å®šã‚’é™¤ãã€ã™ã¹ã¦ã®æ©Ÿèƒ½ãŒå®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆæ¸ˆã¿ã§ã™ã€‚çµ±åˆä½œæ¥­ã®æº–å‚™ãŒã§ãã¦ã„ã¾ã™ã€‚

---
**ä½œæˆæ—¥**: 2025å¹´6æœˆ11æ—¥  
**ä½œæˆè€…**: æ‹…å½“è€…B (Sheets)  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼çŠ¶æ…‹**: æœªãƒ¬ãƒ“ãƒ¥ãƒ¼